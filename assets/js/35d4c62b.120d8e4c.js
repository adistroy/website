"use strict";(self.webpackChunkkubedl_website=self.webpackChunkkubedl_website||[]).push([[591],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return p}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),d=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=d(e.components);return o.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=d(n),p=r,h=m["".concat(s,".").concat(p)]||m[p]||u[p]||a;return n?o.createElement(h,l(l({ref:t},c),{},{components:n})):o.createElement(h,l({ref:t},c))}));function p(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var d=2;d<a;d++)l[d]=n[d];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7912:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return c},default:function(){return m}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),l=["components"],i={sidebar_position:1},s="Introduction",d={unversionedId:"model/intro",id:"model/intro",title:"Introduction",description:"KubeDL Model tracks a model's version and lineage in Kubernetes CRD. It leverages container image to take versioning of a model.",source:"@site/docs/model/intro.md",sourceDirName:"model",slug:"/model/intro",permalink:"/docs/model/intro",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/model/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Tensorboard",permalink:"/docs/training/tensorboard"},next:{title:"Setup",permalink:"/docs/model/setup"}},c=[{value:"ModelVersion",id:"modelversion",children:[],level:3},{value:"Model",id:"model",children:[],level:3}],u={toc:c};function m(e){var t=e.components,n=(0,r.Z)(e,l);return(0,a.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"KubeDL Model tracks a model's version and lineage in Kubernetes CRD. It leverages container image to take versioning of a model.\nEach model version will generate a corresponding image that includes all the model artifacts."),(0,a.kt)("p",null,"In short, KubeDL training generates the KubeDL model and can then later by referenced by KubeDL Serving to serve the model directly."),(0,a.kt)("p",null,"KubeDL provides two CRDs ",(0,a.kt)("inlineCode",{parentName:"p"},"Model")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"ModelVersion")," to accomplish this:"),(0,a.kt)("h3",{id:"modelversion"},"ModelVersion"),(0,a.kt)("p",null,"ModelVersion describes a model's version, its location, who creates this model, the image repo for pushing the model and so on.\nThe backend controller watches this CRD and uses Kaniko to generate a image that incorporates all the artifacts.\nCheck the full ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/alibaba/kubedl/blob/master/apis/model/v1alpha1/modelversion_types.go"},"CRD spec.")),(0,a.kt)("p",null,"An example YAML looks like below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-YAML"},"apiVersion: model.kubedl.io/v1alpha1\nkind: ModelVersion\nmetadata:\n  name: mv-3\n  namespace: default\nspec:\n  # The model name for the model version\n  modelName: model1\n  # The entity (user or training job) that creates the model\n  createdBy: user1\n  # The image repo to push the generated model\n  imageRepo: modelhub/resnet\n  # The storage will be mounted at /kubedl-model inside the training container.\n  # Therefore, the training code should export the model at /kubedl-model path.\n  storage:\n    # The local storage to store the model\n    localStorage:\n      # The local host path to export the model\n      path: /foo\n       # The node where the chief worker run to export the model\n      nodeName: kind-control-plane\n")),(0,a.kt)("p",null,"KubeDL mounts the storage such as local fs, nfs at ",(0,a.kt)("inlineCode",{parentName:"p"},"/kubedl-model")," inside each training container by default. Therefore,\nthe training code inside the container must export the model under ",(0,a.kt)("inlineCode",{parentName:"p"},"/kubedl-model"),", so that it is also present on the external storage."),(0,a.kt)("p",null,"The ModelVersion controller will then trigger a Kaniko container mounted with the same storage and generate an image that includes the\nmodel artifacts at ",(0,a.kt)("inlineCode",{parentName:"p"},"/kubedl-model")," path.\nKubeDL also automatically injects an ENV  ",(0,a.kt)("inlineCode",{parentName:"p"},"KUBEDL_MODEL_PATH=/kubedl-model")," into the generated model image."),(0,a.kt)("h3",{id:"model"},"Model"),(0,a.kt)("p",null,"Model is associated with multiple ModelVersions. It just aggregates some information about the ModelVersions in its status, such as the latest ModelVersion like below.\nOnce the Model is deleted, all its ModelVersions are cascadingly deleted.\nCheck the full ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/alibaba/kubedl/blob/master/apis/model/v1alpha1/model_types.go"},"CRD spec.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-YAML"},"  status:\n    latestVersion:\n      imageName: modelhub/resnet:v1c072\n      modelVersion: mv-3\n")))}m.isMDXComponent=!0}}]);
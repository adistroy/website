<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://kubedl.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://kubedl.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.25a64f66d2c311314f67f78f589f3bd7d271520aabda5b27043214cde174ee5b71cfa398de1188272dab6779bbd49c9b33e9a0f09bb84fb67f01d0e5672e7418.css integrity="sha512-JaZPZtLDETFPZ/ePWJ8719JxUgqr2lsnBDIUzeF07ltxz6OY3hGIJy2rZ3m71JybM+mg8Ju4T7Z/AdDlZy50GA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Mars - KubeDL</title><meta name=description content="Running mars on Kubernetes"><link rel=canonical href=https://kubedl.io/docs/workloads/mars/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Mars"><meta property="og:description" content="Running mars on Kubernetes"><meta property="og:url" content="https://kubedl.io/docs/workloads/mars/"><meta property="og:site_name" content="KubeDL"><meta property="article:published_time" content="2021-03-16T08:43:34+01:00"><meta property="article:modified_time" content="2021-03-16T08:43:34+01:00"><meta property="og:image" content="https://kubedl.io/doks.png"><meta property="og:image:alt" content="KubeDL"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@getdoks"><meta name=twitter:creator content="@henkverlinde"><meta name=twitter:title content="Mars"><meta name=twitter:description content="Running mars on Kubernetes"><meta name=twitter:image content="https://kubedl.io/doks.png"><meta name=twitter:image:alt content="Mars"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://kubedl.io/#/schema/organization/1","name":"Doks","url":"https://kubedl.io/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://kubedl.io/#/schema/image/1","url":"https://kubedl.io/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://kubedl.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://kubedl.io/#/schema/website/1","url":"https://kubedl.io/","name":"KubeDL","description":"KubeDL is a unififed operator helping you run multiple kinds of deep learning training workloads on Kubernetes.","publisher":{"@id":"https://kubedl.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://kubedl.io/docs/workloads/mars/","url":"https://kubedl.io/docs/workloads/mars/","name":"Mars","description":"Running mars on Kubernetes","isPartOf":{"@id":"https://kubedl.io/#/schema/website/1"},"about":{"@id":"https://kubedl.io/#/schema/organization/1"},"datePublished":"2021-03-16T08:43:34CET","dateModified":"2021-03-16T08:43:34CET","breadcrumb":{"@id":"https://kubedl.io/docs/workloads/mars/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://kubedl.io/docs/workloads/mars/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://kubedl.io/docs/workloads/mars/"]}]},{"@type":"BreadcrumbList","@id":"https://kubedl.io/docs/workloads/mars/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://kubedl.io","url":"https://kubedl.io","name":"Home"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://kubedl.io/docs/","url":"https://kubedl.io/docs/","name":"Docs"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://kubedl.io/docs/workloads/","url":"https://kubedl.io/docs/workloads/","name":"Workloads"}},{"@type":"ListItem","position":5,"item":{"@id":"https://kubedl.io/docs/workloads/mars/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://kubedl.io/#/schema/article/1","headline":"Mars","description":"Running mars on Kubernetes","isPartOf":{"@id":"https://kubedl.io/docs/workloads/mars/"},"mainEntityOfPage":{"@id":"https://kubedl.io/docs/workloads/mars/"},"datePublished":"2021-03-16T08:43:34CET","dateModified":"2021-03-16T08:43:34CET","author":{"@id":"https://kubedl.io/#/schema/person/2"},"publisher":{"@id":"https://kubedl.io/#/schema/organization/1"},"image":{"@id":"https://kubedl.io/docs/workloads/mars/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://kubedl.io/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://kubedl.io/docs/workloads/mars/#/schema/image/2","url":"https://kubedl.io/doks.png","contentUrl":"https://kubedl.io/doks.png","caption":"Mars"}]}]}</script><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://kubedl.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://kubedl.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://kubedl.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://kubedl.io/site.webmanifest><link rel=mask-icon href=https://kubedl.io/safari-pinned-tab.svg color=#5bbad5></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=Bootstrap>KubeDL</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>KubeDL</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1" href=/docs/prologue/introduction/>Training</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/model/intro>Model</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/serving/intro>Serving</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/tuning/intro>Morphling</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/docs/contributing/how-to-contribute>Contribute</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/alibaba/kubedl><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://cloud-native.slack.com/archives/C027KH1Q71A><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-slack"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-md-none">Slack</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href="https://h5.dingtalk.com/circle/healthCheckin.html?dtaction=os&corpId=ding66e5c6edd2286ee0daaacaebab5406a2&b2324693-=bf33ff07-&cbdbhh=qwertyuiop#/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg><small class="ms-2 d-md-none">Dingtalk</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-model2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-prologue aria-expanded=false>
Introduction</button><div class=collapse id=section-prologue><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/prologue/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=/docs/prologue/install-using-helm/>Install Using Helm</a></li><li><a class="docs-link rounded" href=/docs/prologue/install-using-yaml/>Install Using Yaml</a></li><li><a class="docs-link rounded" href=/docs/prologue/quick-start/>Quick Start</a></li><li><a class="docs-link rounded" href=/docs/prologue/workloadkinds/>Workload Kinds</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorial aria-expanded=false>
Tutorial</button><div class=collapse id=section-tutorial><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/tutorial/tutorial/>Tutorial</a></li><li><a class="docs-link rounded" href=/docs/tutorial/video/>Video Demo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-workloads aria-expanded=true>
Workloads</button><div class="collapse show" id=section-workloads><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/workloads/pytorch/>PyTorch</a></li><li><a class="docs-link rounded" href=/docs/workloads/tensorflow/>TensorFlow</a></li><li><a class="docs-link rounded active" href=/docs/workloads/mars/>Mars</a></li><li><a class="docs-link rounded" href=/docs/workloads/xgboost/>XGBoost</a></li><li><a class="docs-link rounded" href=/docs/workloads/mpi/>Mpi</a></li><li><a class="docs-link rounded" href=/docs/workloads/cron/>Cron Training</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-recipes aria-expanded=false>
features</button><div class=collapse id=section-recipes><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/recipes/code-sync/>File Sync</a></li><li><a class="docs-link rounded" href=/docs/recipes/hostnetwork/>Host Network</a></li><li><a class="docs-link rounded" href=/docs/recipes/tensorboard/>Tensorboard</a></li><li><a class="docs-link rounded" href=/docs/recipes/metadata-persistency/>Metadata Persistency</a></li><li><a class="docs-link rounded" href=/docs/recipes/events-persistency/>Events Persistency</a></li><li><a class="docs-link rounded" href=/docs/recipes/dashboard/>Dashboard</a></li><li><a class="docs-link rounded" href=/docs/recipes/scheduling/>Gang Scheduling</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-references aria-expanded=false>
References</button><div class=collapse id=section-references><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/references/metrics/>Metrics</a></li><li><a class="docs-link rounded" href=/docs/references/dockerhub/>Docker Images</a></li><li><a class="docs-link rounded" href=/docs/references/flags/>Startup flags</a></li><li><a class="docs-link rounded" href=/docs/references/crd/>Training CRD Spec</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-contributing aria-expanded=false>
contributing</button><div class=collapse id=section-contributing><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/contributing/how-to-contribute/>How to Contribute</a></li><li><a class="docs-link rounded" href=/docs/contributing/code-of-conduct/>Code of Conduct</a></li><li><a class="docs-link rounded" href=/docs/contributing/comparisons/>Comparisons</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/help/dingtalk/>Dingtalk</a></li><li><a class="docs-link rounded" href=/docs/help/troubleshooting/>Troubleshooting</a></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-prologue aria-expanded=false>
Introduction</button><div class=collapse id=section-prologue><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/prologue/introduction/>Introduction</a></li><li><a class="docs-link rounded" href=/docs/prologue/install-using-helm/>Install Using Helm</a></li><li><a class="docs-link rounded" href=/docs/prologue/install-using-yaml/>Install Using Yaml</a></li><li><a class="docs-link rounded" href=/docs/prologue/quick-start/>Quick Start</a></li><li><a class="docs-link rounded" href=/docs/prologue/workloadkinds/>Workload Kinds</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-tutorial aria-expanded=false>
Tutorial</button><div class=collapse id=section-tutorial><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/tutorial/tutorial/>Tutorial</a></li><li><a class="docs-link rounded" href=/docs/tutorial/video/>Video Demo</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-workloads aria-expanded=true>
Workloads</button><div class="collapse show" id=section-workloads><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/workloads/pytorch/>PyTorch</a></li><li><a class="docs-link rounded" href=/docs/workloads/tensorflow/>TensorFlow</a></li><li><a class="docs-link rounded active" href=/docs/workloads/mars/>Mars</a></li><li><a class="docs-link rounded" href=/docs/workloads/xgboost/>XGBoost</a></li><li><a class="docs-link rounded" href=/docs/workloads/mpi/>Mpi</a></li><li><a class="docs-link rounded" href=/docs/workloads/cron/>Cron Training</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-recipes aria-expanded=false>
features</button><div class=collapse id=section-recipes><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/recipes/code-sync/>File Sync</a></li><li><a class="docs-link rounded" href=/docs/recipes/hostnetwork/>Host Network</a></li><li><a class="docs-link rounded" href=/docs/recipes/tensorboard/>Tensorboard</a></li><li><a class="docs-link rounded" href=/docs/recipes/metadata-persistency/>Metadata Persistency</a></li><li><a class="docs-link rounded" href=/docs/recipes/events-persistency/>Events Persistency</a></li><li><a class="docs-link rounded" href=/docs/recipes/dashboard/>Dashboard</a></li><li><a class="docs-link rounded" href=/docs/recipes/scheduling/>Gang Scheduling</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-references aria-expanded=false>
References</button><div class=collapse id=section-references><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/references/metrics/>Metrics</a></li><li><a class="docs-link rounded" href=/docs/references/dockerhub/>Docker Images</a></li><li><a class="docs-link rounded" href=/docs/references/flags/>Startup flags</a></li><li><a class="docs-link rounded" href=/docs/references/crd/>Training CRD Spec</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-contributing aria-expanded=false>
contributing</button><div class=collapse id=section-contributing><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/contributing/how-to-contribute/>How to Contribute</a></li><li><a class="docs-link rounded" href=/docs/contributing/code-of-conduct/>Code of Conduct</a></li><li><a class="docs-link rounded" href=/docs/contributing/comparisons/>Comparisons</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/docs/help/dingtalk/>Dingtalk</a></li><li><a class="docs-link rounded" href=/docs/help/troubleshooting/>Troubleshooting</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#whats-mars>What&rsquo;s Mars</a></li><li><a href=#run-mars-with-kubedl>Run Mars with KubeDL</a><ul><li><a href=#1-deploy-kubedl>1. Deploy KubeDL</a></li><li><a href=#2-apply-mars-crd>2. Apply Mars CRD</a></li><li><a href=#3-create-a-mars-job>3. Create a Mars Job</a></li><li><a href=#4-access-web-service>4. Access web-service.</a></li><li><a href=#5-memory-tuning-policy>5. Memory Tuning Policy</a></li></ul></li><li><a href=#run-mars-in-standalone-mode>Run Mars in Standalone Mode</a></li><li><a href=#crd-spec>CRD Spec</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Mars</h1><p class=lead>Run Mars job with KubeDL</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#whats-mars>What&rsquo;s Mars</a></li><li><a href=#run-mars-with-kubedl>Run Mars with KubeDL</a><ul><li><a href=#1-deploy-kubedl>1. Deploy KubeDL</a></li><li><a href=#2-apply-mars-crd>2. Apply Mars CRD</a></li><li><a href=#3-create-a-mars-job>3. Create a Mars Job</a></li><li><a href=#4-access-web-service>4. Access web-service.</a></li><li><a href=#5-memory-tuning-policy>5. Memory Tuning Policy</a></li></ul></li><li><a href=#run-mars-in-standalone-mode>Run Mars in Standalone Mode</a></li><li><a href=#crd-spec>CRD Spec</a></li></ul></nav></div></nav><h2 id=whats-mars>What&rsquo;s Mars<a href=#whats-mars class=anchor aria-hidden=true>#</a></h2><p><code>Mars</code> is a tensor-based unified framework for large-scale data computation which scales Numpy, Pandas and Scikit-learn,
see <a href=https://github.com/mars-project/mars>mars-repo</a> for details. As a data computation framework, <code>mars</code> is easy to
scale out and can run across hundreds of machines simultaneously to accelerate large scale data tasks.<br></p><p>A distributed mars job includes 3 roles to collaborate with each other：</p><ul><li><strong>WebService</strong>: web-service accepts requests from end-users and forwards the whole tensor-graph to scheduler, it provides a dashboard for end users to track job status and submit tasks interactively.</li><li><strong>Scheduler</strong>: scheduler compiles and holds a global view of tensor-graph, it schedules &lsquo;operands&rsquo; and &lsquo;chunks&rsquo; to workers.</li><li><strong>Worker</strong>: worker listen to &lsquo;operands&rsquo; and &lsquo;chunks&rsquo; dispatched by scheduler, executes the tasks, and reports results back to scheduler.</li></ul><h2 id=run-mars-with-kubedl>Run Mars with KubeDL<a href=#run-mars-with-kubedl class=anchor aria-hidden=true>#</a></h2><p>Run <code>mars</code> job on kubernetes natively.</p><h3 id=1-deploy-kubedl>1. Deploy KubeDL<a href=#1-deploy-kubedl class=anchor aria-hidden=true>#</a></h3><p>Follow the <a href=https://kubedl.io/docs/prologue/introduction/>installation tutorial</a>.</p><h3 id=2-apply-mars-crd>2. Apply Mars CRD<a href=#2-apply-mars-crd class=anchor aria-hidden=true>#</a></h3><p><code>Mars</code> CRD(CustomResourceDefinition) manifest file describes the structure of a mars job spec. Run the following to apply the CRD:</p><pre><code class=language-bash>kubectl apply -f https://raw.githubusercontent.com/alibaba/kubedl/v0.3.0/config/crd/bases/training.kubedl.io_marsjobs.yaml
</code></pre><h3 id=3-create-a-mars-job>3. Create a Mars Job<a href=#3-create-a-mars-job class=anchor aria-hidden=true>#</a></h3><p>Create a YAML spec that describes the requirements of a MarsJob such as the worker, scheduler, WebService like below</p><pre><code class=language-yaml>apiVersion: training.kubedl.io/v1alpha1
kind: MarsJob
metadata:
  name: mars-test-demo
  namespace: default
spec:
  cleanPodPolicy: None
  webHost: mars.domain.com
  marsReplicaSpecs:
    Scheduler:
      replicas: 1
      restartPolicy: Never
      template:
        metadata:
          labels:
            mars/service-type: marsscheduler
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - python -m mars.deploy.kubernetes.scheduler
              image: mars-image
              imagePullPolicy: Always
              name: mars
              resources:
                limits:
                  cpu: 2
                  memory: 2Gi
                requests:
                  cpu: 2
                  memory: 2Gi
          serviceAccountName: kubedl-sa
    WebService:
      replicas: 1
      restartPolicy: Never
      template:
        metadata:
          labels:
            mars/service-type: marswebservice
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - python -m mars.deploy.kubernetes.web
              image: mars-image
              imagePullPolicy: Always
              name: mars
              resources:
                limits:
                  cpu: 2
                  memory: 2Gi
                requests:
                  cpu: 2
                  memory: 2Gi
          serviceAccountName: kubedl-sa
    Worker:
      replicas: 2
      restartPolicy: Never
      template:
        metadata:
          labels:
            mars/service-type: marsworker
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - python -m mars.deploy.kubernetes.worker
              image: mars-image
              imagePullPolicy: Always
              name: mars
              resources:
                limits:
                  cpu: 2
                  memory: 2Gi
                requests:
                  cpu: 2
                  memory: 2Gi
          serviceAccountName: kubedl-sa
status: {}
</code></pre><p>The <code>spec</code> field describes the requirement of each replica, including <code>replicas</code>, <code>restartPolicy</code>, <code>template</code>&mldr;and
the <code>status</code> field describes the job current status. Run following command to start an example mars job:</p><pre><code class=language-bash>kubectl create -f example/mars/mars-test-demo.yaml
</code></pre><p>Check the mars job status:</p><pre><code class=language-bash>$ kubectl get marsjob
NAME             STATE     AGE   FINISHED-TTL   MAX-LIFETIME
mars-test-demo   Running   40m
$ kubectl get pods
NAME                                            READY   STATUS             RESTARTS   AGE
mars-test-demo-scheduler-0                      1/1     Running            0          40m
mars-test-demo-webservice-0                     1/1     Running            0          40m
mars-test-demo-worker-0                         1/1     Running            0          40m
mars-test-demo-worker-1                         1/1     Running            0          40m

</code></pre><h3 id=4-access-web-service>4. Access web-service.<a href=#4-access-web-service class=anchor aria-hidden=true>#</a></h3><figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_20x0_resize_box_3.png data-srcset="https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_900x0_resize_box_3.png 900w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_800x0_resize_box_3.png 800w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_700x0_resize_box_3.png 700w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_600x0_resize_box_3.png 600w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_500x0_resize_box_3.png 500w" width=892 height=452 alt=mars-ingress><noscript><img class=img-fluid sizes=100vw srcset="https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_900x0_resize_box_3.png 900w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_800x0_resize_box_3.png 800w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_700x0_resize_box_3.png 700w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_600x0_resize_box_3.png 600w,https://kubedl.io/docs/workloads/mars/mars-ingress_hu3d024fe99bd4d562ba755cd6f9fa87db_47305_500x0_resize_box_3.png 500w" src=/docs/workloads/mars/mars-ingress.png width=892 height=452 alt=mars-ingress></noscript><figcaption class=figure-caption>mars-ingress</figcaption></figure><p>Web service visualizes job status, computation process progress and provides an entry for interactive submission.
However, web service instance was running as a pod inside a kubernetes cluster which may not be accessible by external users.
<code>KubeDL</code> provides two access modes for users in different network environment.</p><h4 id=41-access-web-service-in-cluster>4.1 Access web-service in-cluster.<a href=#41-access-web-service-in-cluster class=anchor aria-hidden=true>#</a></h4><p>For users in the same network environment with web service instance, they can directly access its <em>service</em> without any other additional configurations,
and the address is formatted as: <code>{webservice-name}.{namespace}</code>, it is a <code>A</code> record generated by <code>CoreDNS</code>, so you have to ensure that <code>CoreDNS</code> has been
deployed.</p><h4 id=42-access-web-service-outside-cluster>4.2 Access web-service outside cluster.<a href=#42-access-web-service-outside-cluster class=anchor aria-hidden=true>#</a></h4><p>For users in different network environment(e.g. an internet user wants to access a mars web-service running in vpc),
users have to apply an SLB address first, so that they can ping the ip in <strong>vpc</strong> with a public address by SLB domain resolving, then in job spec, users just need fill the <code>spec.webHost</code> field with
their applied SLB address, <code>KubeDL</code>will generated ingress instance with routing rules, so that external traffic can be routed to target web service and that
becomes available for outside users.</p><h3 id=5-memory-tuning-policy>5. Memory Tuning Policy<a href=#5-memory-tuning-policy class=anchor aria-hidden=true>#</a></h3><p><code>Worker</code> is the role that actually performs computing tasks in <code>MarsJob</code>.
Mars supports running jobs in different memory usage scenarios. For example, swap cold in-memory data out to spill dirs and persist in kubernetes ephemeral-storage.
<code>Mars</code> provides plentiful memory tuning options which has been integrated to <code>MarsJob</code> type definition, including :</p><ul><li>plasmaStore: PlasmaStore specify the socket path of plasma store that handles shared memory between all worker processes.</li><li>lockFreeFileIO: LockFreeFileIO indicates whether spill dirs are dedicated or not.</li><li>spillDirs: SpillDirs specify multiple directory paths, when size of in-memory objects is about to reach the limitation, mars workers will swap cold data out to spill dirs and persist in ephemeral-storage.</li><li>workerCachePercentage: WorkerCachePercentage specify the percentage of total available memory size can be used as cache, it will be overridden by workerCacheSize if it is been set.</li><li>workerCacheSize：WorkerCacheSize specify the exact cache quantity can be used.</li></ul><p>users can set above options in <code>job.spec.memoryTuningPolicy</code> field:</p><pre><code class=language-yaml>apiVersion: training.kubedl.io/v1alpha1
kind: MarsJob
metadata:
  name: mars-test-demo
  namespace: default
spec:
  cleanPodPolicy: None
  memoryTuningPolicy:
    plasmaStore: string              # /etc/pstore/...
    lockFreeFileIO: bool             # false
    spillDirs: []string              # ...
    workerCachePercentage: int32     # 80, indicates 80%
    workerCacheSize: quantity        # 10Gi
  marsReplicaSpecs:
    ...
</code></pre><h2 id=run-mars-in-standalone-mode>Run Mars in Standalone Mode<a href=#run-mars-in-standalone-mode class=anchor aria-hidden=true>#</a></h2><p>In standalone mode, a distributed <code>Mars</code> job are running standalone on bare hosts without the help of other container orchestration tools.
But this requires manual configuration effort and lack other abilities such as automatic failover of workers.</p><ol><li>run <code>pip install pymars[distributed]</code> on every node in the cluster to install dependencies needed for distributed execution.</li><li>start different mars role processes on each node.<ul><li><code>mars-scheduler -a &lt;scheduler_ip> -p &lt;scheduler_port></code></li><li><code>mars-web -a &lt;web_ip> -p &lt;web_port> -s &lt;scheduler_ip>:&lt;scheduler_port></code></li><li><code>mars-worker -a &lt;worker_ip> -p &lt;worker_port> -s &lt;scheduler_ip>:&lt;scheduler_port></code></li></ul></li><li>usually there must be at least 1 web-service and 1 scheduler and a certain number of workers.</li><li>after all processes started, users can open the python console run snippet to create a session with web-service and submit tasks.</li></ol><pre><code class=language-python>import mars.tensor as mt
import mars.dataframe as md
from mars.session import new_session
new_session('http://&lt;web_ip&gt;:&lt;web_port&gt;').as_default()
a = mt.ones((2000, 2000), chunk_size=200)
b = mt.inner(a, a)
b.execute()  # submit tensor to cluster
df = md.DataFrame(a).sum()
df.execute()  # submit DataFrame to cluster
</code></pre><h2 id=crd-spec>CRD Spec<a href=#crd-spec class=anchor aria-hidden=true>#</a></h2><p>Check the CRD definition. <a href=https://github.com/alibaba/kubedl/blob/master/apis/training/v1alpha1/marsjob_types.go>Go -></a></p><div class=my-n3></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"></div></div></div><div class=container><div class=row><div align=center><b>KUBEDL IS A CLOUD NATIVE COMPUTING FOUNDATION PROJECT</b></div><div align=center><img src=https://camo.githubusercontent.com/8aee669db45b82619559ea89a92cfa656ef700a1eddb3aa4eefb140ec9187551/68747470733a2f2f7636642e696f2f5f7374617469632f636e63662d636f6c6f722e737667 width=500 title></div><div align=center style="width:800px;margin:0 auto" ;><p>The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage/>Trademark Usage page.</a></p></div></div></div></footer><script src=/js/bootstrap.min.73ca27033146a505b6a0f66b79d99f613a18e778bc9606fd223476d0ebf0fc10508b0d4f5c448b0a946fa1d71fbeffaae9732adc0c2890e61c449217fd6ee1c0.js integrity="sha512-c8onAzFGpQW2oPZredmfYToY53i8lgb9IjR20Ovw/BBQiw1PXESLCpRvodcfvv+q6XMq3AwokOYcRJIX/W7hwA==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.e13cfba4c5524e30386cb9ea71f0f191f39d15b25b222f4b67549689f7c076158f42a2282446044f5cdacc76a6d003efbfa252a84aea0116703803b6339ae35f.js integrity="sha512-4Tz7pMVSTjA4bLnqcfDxkfOdFbJbIi9LZ1SWiffAdhWPQqIoJEYET1zazHam0APvv6JSqErqARZwOAO2M5rjXw==" crossorigin=anonymous defer></script>
<script src=/main.min.bfb6b781dd5fd7177a7a9b3ce0bd84f12db95f6aa4e3fc7b339cd57879c38390d1e8d75cf314836a71201ba2fd6a2e26084a956704964c0bb884c26e9eff5ee1.js integrity="sha512-v7a3gd1f1xd6eps84L2E8S25X2qk4/x7M5zVeHnDg5DR6Ndc8xSDanEgG6L9ai4mCEqVZwSWTAu4hMJunv9e4Q==" crossorigin=anonymous defer></script>
<script src=/index.min.46ecde786d15edac6283626a73a8edafee9355092624c54e3bdfbef47c9e3136c28302d3cfb2f7d3114a12ef3352cd08f91994679f88f7b40fcb75a10bf9b700.js integrity="sha512-RuzeeG0V7axig2Jqc6jtr+6TVQkmJMVOO9++9HyeMTbCgwLTz7L30xFKEu8zUs0I+RmUZ5+I97QPy3WhC/m3AA==" crossorigin=anonymous defer></script></body></html>